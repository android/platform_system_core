{
  "comments": [
    {
      "key": {
        "uuid": "149cbc21_774bb2be",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2019-03-28T16:49:21Z",
      "side": 1,
      "message": "when does this happen? just if you give us a bad fd? in which case should we just abort clearly?\n\nreturning -1 worries me. it\u0027s not mentioned in the doc comment, but even if it was --- folks who don\u0027t check will think they just got PROT_READ|PROT_WRITE|PROT_EXEC.\n\neasier and safer to just blow up?",
      "revId": "0473dea29183e82728221ca68b726c3d82d19000",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e530b68_b202926d",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1000411
      },
      "writtenOn": "2019-03-28T17:35:31Z",
      "side": 1,
      "message": "Good point. I\u0027m not a big fan of crashing the app for something as trivial (and I believe we do have at least one test that intentionally sends an invalid file descriptor to our Ashmem wrapper class, which might trigger this), but we could do that, or simply return 0, which would be at least consistent and slightly less error prone. Which one would you prefer?",
      "parentUuid": "149cbc21_774bb2be",
      "revId": "0473dea29183e82728221ca68b726c3d82d19000",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c89316bf_154879b0",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1010103
      },
      "writtenOn": "2019-03-28T17:38:42Z",
      "side": 1,
      "message": "I\u0027d say an error return is fine instead of abort but it needs to be documented, such as ashmem_get_size documenting it returns 0 if it\u0027s not a valid fd.",
      "parentUuid": "0e530b68_b202926d",
      "revId": "0473dea29183e82728221ca68b726c3d82d19000",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f893bef_3df66a9a",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1000411
      },
      "writtenOn": "2019-03-28T17:48:29Z",
      "side": 1,
      "message": "Actually, it looks like ashmem_get_size_region() already has an inconsistent behaviour in case of invalid file descriptor:\n\n- If memfd support is enabled, it returns an error code (-1)\n- Otherwise, it will crash the process due to the use of __ashmem_check_failure()\n\nSo I don\u0027t know what to think here??",
      "parentUuid": "c89316bf_154879b0",
      "revId": "0473dea29183e82728221ca68b726c3d82d19000",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}