{
  "comments": [
    {
      "key": {
        "uuid": "357bd831_cde347b6",
        "filename": "fs_mgr/fs_mgr_fstab.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-17T21:01:57Z",
      "side": 1,
      "message": "If you store this in /metadata/gsi instead, you won\u0027t have to update sepolicy. Right now callers that care about GSI-in-fstab will already have a dontaudit or allow rule in place for GSI files, but not for ro.gsid properties.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "83883b8e_8fb16b22",
        "filename": "fs_mgr/fs_mgr_fstab.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "That\u0027s a really great idea. Fixed in the new set.",
      "parentUuid": "357bd831_cde347b6",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c5c393b_c597bb27",
        "filename": "fs_mgr/fs_mgr_fstab.cpp",
        "patchSetId": 2
      },
      "lineNbr": 842,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-17T18:12:27Z",
      "side": 1,
      "message": "Might be worth adding a comment here as to why we\u0027re including the partition twice for both file system types.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "83dc46e7_60e5fbb7",
        "filename": "fs_mgr/fs_mgr_fstab.cpp",
        "patchSetId": 2
      },
      "lineNbr": 842,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "Got it. No problem",
      "parentUuid": "8c5c393b_c597bb27",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8c7ef523_4a2de759",
        "filename": "fs_mgr/include_fstab/fstab/fstab.h",
        "patchSetId": 2
      },
      "lineNbr": 111,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-17T18:12:27Z",
      "side": 1,
      "message": "If the fstab is unmodified, then it should be `const Fstab\u0026 fstab`.  The vector should also be `const std::vector\u003cstd::string\u003e\u0026 logical_partitions` since we don\u0027t want to pass it by value.\n\nAlso, it\u0027s probably a good time to rename this function, right?  It seems that \u0027Dsu\u0027 should be preferred over \u0027Gsi\u0027.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e1d8782_6280a359",
        "filename": "fs_mgr/include_fstab/fstab/fstab.h",
        "patchSetId": 2
      },
      "lineNbr": 111,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "Ack.",
      "parentUuid": "8c7ef523_4a2de759",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70698fb6_8fed61fe",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 642,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-17T18:12:27Z",
      "side": 1,
      "message": "In retrospect, even the old code is wrong since it should use remove_if()/erase() to handle multiple lines for the same partition.\n\nBut here, you need fstab_.erase(old_entry, fstab_.end()).\n\nhttps://en.wikipedia.org/wiki/Eraseâ€“remove_idiom\n\nThough, how does this interact with the code in BuildGsiFstabEntries() that creates 2 fstab entries for partitions that are not mounted ext4?  It seems that the second entry would delete the first entry in this list.  You may need to loop through the new fstab entries twice: the first time to remove the old entries and the second time to add the new entries.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "356d442e_b259e5bd",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 642,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "I see. You are right. Cases with multiple entries are not properly handled here. I refactored this function in the new set which can support multiple entries in a more comprehensive way.",
      "parentUuid": "70698fb6_8fed61fe",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "279c8695_ec276f88",
        "filename": "init/init.cpp",
        "patchSetId": 2
      },
      "lineNbr": 718,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2019-09-17T18:12:27Z",
      "side": 1,
      "message": "If we were to link liblp into libfstab, then we\u0027d need to make liblp/libfs_mgr vendor_available, right?  That would be worse, so I\u0027m fine with this though it is a bit unfortunate.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "81866106_b4ec430e",
        "filename": "init/init.cpp",
        "patchSetId": 2
      },
      "lineNbr": 718,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "Yes. It was the attempt but linking liblp would introduce vendor_available\u003dtrue to many libraries. Luckily, by taking David\u0027s suggestion to store this information under /metadata/gsi, we can remove this.",
      "parentUuid": "279c8695_ec276f88",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "86570cda_ab0e051d",
        "filename": "init/init.cpp",
        "patchSetId": 2
      },
      "lineNbr": 722,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-17T21:01:57Z",
      "side": 1,
      "message": "Note: partition.name is not guaranteed to be null-terminated. Use GetPartitionName(partition) to get an std::string. But I think avoiding properties will be easier if the only use is to propagate names to ReadDefaultFstab.",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4388b6a8_c9f65ccc",
        "filename": "init/init.cpp",
        "patchSetId": 2
      },
      "lineNbr": 722,
      "author": {
        "id": 1135739
      },
      "writtenOn": "2019-09-18T11:44:17Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "86570cda_ab0e051d",
      "revId": "72117550a84f5612bf51ec6ed07d833c4b21aa48",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}